import{f as z,c as o,s,e as le,a as f,t as $,r as l,b as U}from"../chunks/disclose-version.BZrHNTVx.js";import{p as ie,s as n,u as ne,t as g,a as de,b as h,g as e,d as b,c as _}from"../chunks/runtime.C5r0zYmH.js";import{s as fe}from"../chunks/render.CRQRsRPV.js";import{i as x}from"../chunks/props.DX6McTcK.js";import{e as V,i as W}from"../chunks/each.DoOZkgPs.js";import{r as pe,s as A}from"../chunks/attributes.DtTHR9Og.js";import{b as me}from"../chunks/input.D8sY2ar0.js";import{p as w}from"../chunks/proxy.BBwd8Nu9.js";import{b as ce,M as ue}from"../chunks/Message.BTZMcoix.js";import{b as ve}from"../chunks/this.CU4v1nvf.js";import{s as ge,a as he}from"../chunks/store.CfCFyRpl.js";import{m as r,c as be}from"../chunks/index.svelte.BH7fYai9.js";import{p as _e}from"../chunks/stores.CDPZV4_Q.js";import{g as H}from"../chunks/entry.e2QEpWJh.js";import{b as J}from"../chunks/paths.CWnAbLKo.js";var xe=$('<a class="px-2 bg-accent rounded-md"> </a>'),we=$('<div class="flex flex-col gap-2 pt-2">Куда дальше? <!></div>'),$e=$("<a>До конца</a>"),ye=$('<div class="flex-grow flex flex-col overflow-y-hidden"><div class="flex flex-col container mx-auto overflow-y-scroll"><!> <!> <!></div> <div class="block"></div></div> <footer class="dark:text-white bg-slate-100 dark:bg-slate-700 border-t border-gray-300 fixed bottom-0 left-0 dark:border-slate-600 px-4 py-2 md:py-4 w-full"><form class="flex items-center container mx-auto"><input type="text" placeholder="Type a message..." class="w-full p-2 focus:outline-none focus:border-blue-500 bg-transparent"> <button class="py-2 rounded-md ml-2" type="submit"><svg xmlns="http://www.w3.org/2000/svg" class="w-8 h-8 fill-current" viewBox="0 0 64 64"><defs><clipPath id="a"><rect width="64" height="64"></rect></clipPath></defs><g clip-path="url(#a)"><path d="M 8.216 36.338 L 26.885 32.604 C 28.552 32.271 28.552 31.729 26.885 31.396 L 8.216 27.662 C 7.104 27.44 6.021 26.356 5.799 25.245 L 2.065 6.576 C 1.731 4.908 2.714 4.133 4.259 4.846 L 61.228 31.139 C 62.257 31.614 62.257 32.386 61.228 32.861 L 4.259 59.154 C 2.714 59.867 1.731 59.092 2.065 57.424 L 5.799 38.755 C 6.021 37.644 7.104 36.56 8.216 36.338 Z "></path></g></svg></button></form></footer>',1);function Fe(X,Y){ie(Y,!0);const ee=ge(),p=()=>he(_e,"$page",ee);let i=h(null);if(p().url.hash!=="")n(i,w(p().url.hash.substring(1)));else if(r.length>0){let t=p().url;t.hash=r.lastCreatedAt().id,H(t)}ne(()=>{n(i,w(p().url.hash.substring(1)))});let y=b(()=>r.get(e(i))),N=b(()=>r.chatFrom(e(i),100).toReversed()),m=b(()=>r.untilBranchOrLeaf(e(i))),c=h(""),L=h(null);function te(){let t=be(e(c));n(i,w(r.add(e(i),t))),n(c,""),localStorage.setItem("notes",JSON.stringify(r.export()));let a=p().url;a.hash=e(i),H(a),setTimeout(()=>e(L).focus(),0)}function ae(t){if(r.isLeaf(t.id)){let a=t.parent??r.lastCreatedAt().id;H(`${J}/#${a}`)}r.delete(t.id),localStorage.setItem("notes",JSON.stringify(r.export()))}let T=h(0);var E=ye(),C=z(E),I=o(C),F=o(I);x(F,()=>e(N),t=>{var a=U(),S=z(a);V(S,65,()=>e(N),W,(B,d,G)=>{var P=b(()=>_(d).id===e(m));ue(B,{get value(){return _(d)},ondelete:ae,get isLast(){return e(P)}})}),f(t,a)});var R=s(s(F,!0));x(R,()=>e(y),t=>{var a=U(),S=z(a);x(S,()=>e(y).children.size>1,B=>{var d=we(),G=s(o(d));V(G,65,()=>e(y).children,W,(P,K,Le)=>{var v=xe();g(()=>A(v,"href",`${J??""}/#${r.untilBranchOrLeaf(_(K))??""}`));var oe=o(v);g(()=>{var Q;return fe(oe,(Q=r.get(_(K)))==null?void 0:Q.data.content)}),l(v),f(P,v)}),l(d),f(B,d)}),f(t,a)});var re=s(s(R,!0));x(re,()=>e(m)&&e(m)!==e(i),t=>{var a=$e();g(()=>A(a,"href",`${J??""}/#${e(m)??""}`)),f(t,a)}),l(I);var se=s(s(I,!0));l(C);var M=s(s(C,!0)),k=o(M),u=o(k);ve(u,t=>n(L,w(t)),()=>e(L)),pe(u);var Z=s(s(u,!0)),j=o(Z),O=o(j),q=o(O);o(q),l(q),l(O);var D=s(O);o(D),l(D),l(j),l(Z),l(k),l(M),g(()=>A(se,"style",`height: ${e(T)+16}px`)),ce(M,"clientHeight",t=>n(T,t)),le("submit",k,te,!1),me(u,()=>e(c),t=>n(c,t)),f(X,E),de()}export{Fe as component};

var l=Object.defineProperty;var u=(s,e,t)=>e in s?l(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var i=(s,e,t)=>u(s,typeof e!="symbol"?e+"":e,t);import{h as c,l as d,q as f}from"./template.CFHl0Kkw.js";import{q as m}from"./runtime.CPjQUAmY.js";import{p as h}from"./proxy.tfkVzh6H.js";function A(s,e,t,n){c&&d(),e===void 0||e(s,t)}function O(s,e){if(e){const t=document.body;s.autofocus=!0,m(()=>{document.activeElement===t&&s.focus()})}}function w(s){c&&s.firstChild!==null&&f(s)}let o=!1;function j(){o||(o=!0,document.addEventListener("reset",s=>{Promise.resolve().then(()=>{var e;if(!s.defaultPrevented)for(const t of s.target.elements)(e=t.__on_r)==null||e.call(t)})},{capture:!0}))}function q(s){var t;var e=(t=s.$$slots)==null?void 0:t.default;return e===!0?s.children:e}const g="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let _=(s=21)=>{let e="",t=crypto.getRandomValues(new Uint8Array(s));for(;s--;)e+=g[t[s]&63];return e};const p={next(){return _()}};function D(s){return{content:s,createdAt:Date.now()}}class b{constructor(e=p){i(this,"messages",{});this.id_provider=e}insert(e,t){const n={data:t,id:e,children:new Set,parent:null};this.messages[e]=n}add(e,t){const n=this.id_provider.next();return this.insert(n,t),e&&this.link(e,n),n}get length(){return Object.keys(this.messages).length}link(e,t){this.messages[e].children.add(t),this.messages[t].parent=e}chatFrom(e,t=20){const n=[];let a=e;for(;t-- >0;){const r=this.messages[a];if(!r)break;a=r.parent,n.push(r)}return n}lastCreatedAt(){const e=Object.values(this.messages);return e.length<1?null:e.reduce((t,n)=>t.data.createdAt>n.data.createdAt?t:n)}export(){const e={},t={};for(const n of Object.values(this.messages))t[n.id]=n.data,n.parent&&(e[n.id]=n.parent);return{links:e,messages:t}}import(e){for(const[t,n]of Object.entries(e.messages))this.insert(t,n);for(const[t,n]of Object.entries(e.links))this.link(n,t)}clear(){this.messages={}}}const E=h(new b);export{j as a,O as b,D as c,q as d,E as m,w as r,A as s};

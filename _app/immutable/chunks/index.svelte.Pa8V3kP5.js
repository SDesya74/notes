var l=Object.defineProperty;var d=(s,e,t)=>e in s?l(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var a=(s,e,t)=>d(s,typeof e!="symbol"?e+"":e,t);import{h as c,l as u,q as f}from"./template.CptAR0ur.js";import{q as m}from"./runtime.ghMM8PmF.js";import{p as h}from"./proxy.DLQEeM7u.js";function A(s,e,t,n){c&&u(),e===void 0||e(s,t)}function E(s,e){if(e){const t=document.body;s.autofocus=!0,m(()=>{document.activeElement===t&&s.focus()})}}function R(s){c&&s.firstChild!==null&&f(s)}let o=!1;function j(){o||(o=!0,document.addEventListener("reset",s=>{Promise.resolve().then(()=>{var e;if(!s.defaultPrevented)for(const t of s.target.elements)(e=t.__on_r)==null||e.call(t)})},{capture:!0}))}function I(s){var t;var e=(t=s.$$slots)==null?void 0:t.default;return e===!0?s.children:e}const g="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let _=(s=21)=>{let e="",t=crypto.getRandomValues(new Uint8Array(s));for(;s--;)e+=g[t[s]&63];return e};const p={next(){return _()}};class b{constructor(){a(this,"id",0)}next(){return(this.id++).toString()}}const k=new b;function P(s){return{content:s,createdAt:Date.now()}}class v{constructor(e=p){a(this,"messages",{});this.id_provider=e}insert(e,t){const n={data:t,id:e,children:new Set,parent:null};this.messages[e]=n}add(e,t){const n=this.id_provider.next();return this.insert(n,t),e&&this.link(e,n),n}get length(){return Object.keys(this.messages).length}link(e,t){this.messages[e].children.add(t),this.messages[t].parent=e}chatFrom(e,t=20){const n=[];let i=e;for(;t-- >0;){const r=this.messages[i];if(!r)break;i=r.parent,n.push(r)}return n}lastCreatedAt(){const e=Object.values(this.messages);return e.length<1?null:e.reduce((t,n)=>t.data.createdAt>n.data.createdAt?t:n)}export(){const e={},t={};for(const n of Object.values(this.messages))t[n.id]=n.data,n.parent&&(e[n.id]=n.parent);return{links:e,messages:t}}import(e){for(const[t,n]of Object.entries(e.messages))this.insert(t,n);for(const[t,n]of Object.entries(e.links))this.link(n,t)}clear(){this.messages={}}}const D=h(new v(k));export{E as a,j as b,P as c,I as d,D as m,R as r,A as s};

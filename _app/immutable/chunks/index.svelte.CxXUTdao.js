var l=r=>{throw TypeError(r)};var f=(r,e,t)=>e.has(r)||l("Cannot "+t);var o=(r,e,t)=>(f(r,e,"read from private field"),t?t.call(r):e.get(r)),c=(r,e,t)=>e.has(r)?l("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t);import{h as m,q as g}from"./disclose-version.QqCXY2iz.js";import{q as p,x as _,H as b,v as k}from"./runtime.D-T8yC8_.js";import{p as u}from"./proxy.B1FLLVMe.js";function C(r,e){if(e){const t=document.body;r.autofocus=!0,p(()=>{document.activeElement===t&&r.focus()})}}function E(r){m&&r.firstChild!==null&&g(r)}let h=!1;function q(){h||(h=!0,document.addEventListener("reset",r=>{Promise.resolve().then(()=>{var e;if(!r.defaultPrevented)for(const t of r.target.elements)(e=t.__on_r)==null||e.call(t)})},{capture:!0}))}const v="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let x=(r=21)=>{let e="",t=crypto.getRandomValues(new Uint8Array(r));for(;r--;)e+=v[t[r]&63];return e};const d={next(){return x()}};function D(r){return{content:r,createdAt:Date.now()}}var a;class w{constructor(e=d){c(this,a,_(u({})));this.id_provider=e}get inner(){return b(o(this,a))}set inner(e){k(o(this,a),u(e))}get(e){return this.inner[e]??null}insert(e,t){const n={data:t,id:e,children:new Set,parent:null};this.inner[e]=n}add(e,t){const n=this.id_provider.next();return this.insert(n,t),e&&this.link(e,n),n}delete(e){const t=this.inner[e];t&&(t.children.size>0&&t.parent&&t.children.forEach(n=>{this.link(t.parent,n)}),t.parent&&this.unlink(t.parent,e),delete this.inner[e])}get length(){return Object.keys(this.inner).length}link(e,t){this.inner[e].children.add(t),this.inner[t].parent=e}unlink(e,t){this.inner[e].children.delete(t),this.inner[t].parent=null}isLeaf(e){return this.inner[e].children.size===0}chatFrom(e,t=20){const n=[];let i=e;for(;t-- >0;){const s=this.inner[i];if(!s)break;i=s.parent,n.push(s)}return n}untilBranchOrLeaf(e){let t=e;for(;t;){const n=this.inner[t];if(!n||n.children.size!==1)break;t=n.children.values().next().value}return t}lastCreatedAt(){const e=Object.values(this.inner);return e.length<1?null:e.reduce((t,n)=>t.data.createdAt>n.data.createdAt?t:n)}export(){const e={},t={};for(const n of Object.values(this.inner))t[n.id]=n.data,n.parent&&(e[n.id]=n.parent);return{links:e,messages:t}}import(e){for(const[t,n]of Object.entries(e.messages))this.insert(t,n);for(const[t,n]of Object.entries(e.links))this.link(n,t)}updateTransform(e,t,n,i){const s=this.inner[e];s?s.data.transform={position:t,width:n,height:i}:console.error(`Message with id ${e} does not exist.`)}clear(){this.inner={}}}a=new WeakMap;const L=new w(d);export{q as a,C as b,D as c,L as m,E as r};
